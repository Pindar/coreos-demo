[Unit]
Description=RabbitMQ service
After=docker.service

[Service]
TimeoutSec=180
ExecStartPre=/usr/bin/docker pull rabbitmq:3

ExecStart=/bin/bash -c '\
  docker run \
  -p 5672:5672 \
  -e RABBITMQ_NODENAME=%p-%i \
  -e SERVICE_ID=%p-%i \
  --name %p-%i \
  rabbitmq:3'

ExecStop=/usr/bin/docker stop %p-%i
ExecStop=/usr/bin/docker rm %p-%i

[X-Fleet]
Conflicts=%p@*.service


